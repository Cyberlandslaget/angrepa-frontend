import { CONFIG } from 'utils/constants';
import { ExploitType } from 'utils/types';

const getExploits = async () => {
  return await fetch(`${CONFIG.MGMT_SERVER_URL}/logs/exploits`)
    .then((res) => res.json())
    .then((data: { status: 'ok' | 'error'; data: ExploitType[] }) => {
      if (data.status === 'error') return null;
      return data.data;
    })
    .catch((_err) => null)
    .finally(() => null);
};

export default getExploits;
